use c.printf

let HANDLE = int

foreign("system:kernel32") {
    let GetStdHandle = fn(handle: i32) -> HANDLE
    let WriteFile = fn(
		status: i64, 
		buffer: [u8; *], 
		size: uint, 
		bytes_written: *mut i32, 
		overlapped: *i64
	) -> i64
}

let main = fn() {
	let std_out = GetStdHandle(-11)

	printf("handle = %d\n".data, std_out)

	let msg = "Hello, World!\n"
	let bytes_written: i32
	WriteFile(std_out, msg.data, msg.len, &mut bytes_written, 0 as uint as _)
}